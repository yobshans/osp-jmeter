#!/usr/bin/env ansible-playbook
---
- name: Direct deploy
  hosts: undercloud-0
  tasks:

    - name: Prepare undercloud for direct deploy
      shell: |
        source ~/stackrc
        openstack role add --user admin --project service ResellerAdmin
        openstack --os-project-name service object store account set --property Temp-URL-Key=$(uuidgen | sha1sum | awk '{print $1}')
        for node in $(openstack baremetal node list -f value -c UUID); do openstack baremetal node set $node --driver ipmi --deploy-interface direct; done

# --------------------------------------------------------------------------------------------------------------------------------------
# END
# --------------------------------------------------------------------------------------------------------------------------------------

